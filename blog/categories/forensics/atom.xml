<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: forensics | Zeus@HackOlympus:~$]]></title>
  <link href="http://hackolympus.com//blog/categories/forensics/atom.xml" rel="self"/>
  <link href="http://hackolympus.com/"/>
  <updated>2021-12-04T03:11:00+05:30</updated>
  <id>http://hackolympus.com/</id>
  <author>
    <name><![CDATA[Zeus]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Magic Number]]></title>
    <link href="http://hackolympus.com/blog/2020/10/16/Magic-Number/"/>
    <updated>2020-10-16T00:00:00+05:30</updated>
    <id>http://hackolympus.com/blog/2020/10/16/Magic-Number</id>
    <content type="html"><![CDATA[<p>Ever heard of file signatures or magic number of a file ?</p>

<ul>
<li><p>File Signature or magic number are special parts in the starting of hex-dump through which we can interpret the file type/extension</p></li>
<li><p>We can use magic number to solve ctf challenges and forensics.</p></li>
<li><p>Sometimes files get corrupt because there is a change in magic number. Solving this problem can un-corrupt that respective file.</p></li>
<li><p>to see magic number we use any hexadecimal editor or viewer.</p></li>
</ul>


<p>for this tutorial I&rsquo;ll use xxd but windows users can use <a href="https://mh-nexus.de/en/hxd/">HxD</a>.</p>

<h3>xxd</h3>

<p>xxd is a tool to make hexdump or reverse that is convert hexdumpt to binary.</p>

<p><strong>general syntax</strong>: <code>xxd &lt;flag&gt; &lt;filename&gt;</code></p>

<p>When no flag is given xxd, standard output is printed by xxd.</p>

<p><strong>Important flags</strong>:</p>

<ul>
<li><strong><em>-b</em></strong> - show binary dump instead of hexdump</li>
<li><strong><em>-c</em></strong> - output is in the form of &lsquo;C&rsquo; include file style</li>
<li><strong><em>-ps</em></strong> - detailed hexdump</li>
</ul>


<p>Now I would like to introduce you to a command <strong><em>&lsquo;head&rsquo;</em></strong>.</p>

<h3>Head command</h3>

<p>This command basically outputs few starting lines of the file.</p>

<p><strong>general syntax</strong>: <code>head &lt;flag&gt; &lt;file&gt;</code></p>

<p>If no flag is given then by default this will print the first 10 lines of a file</p>

<p><strong>important flags</strong>:</p>

<ul>
<li><strong><em>-n</em></strong> <num> - &ldquo;-n&rdquo; followed by a number, will print that respective number of lines.</li>
<li><strong>-q</strong> - this will never print header of file containing its name</li>
<li><strong>-c</strong> <num>- &ldquo;-c&rdquo; followed by a number will print the given number of bytes of a file from the start.</li>
</ul>


<p>So now you know the necessary commands lets get back to magic number.</p>

<p>So as I was saying that starting bytes of a file will tell us about the extension of the file.</p>

<p>so what we do with <em>xxd</em> and <em>head</em> is, we print the first few lines of hexdump. This few lines contains our magic number.We look for a special sequence of hex this special sequence is known as magic number and this will tell us the extension of file.</p>

<p>You&rsquo;ll understand it more clearly by the following example.</p>

<p>I have a file.</p>

<p><img src="https://hackolympus.files.wordpress.com/2020/11/image-3.png?w=495" alt="" /></p>

<p><img src="http://hackolympus.com/images/magic-number/image-3.png"></p>

<p>I don&rsquo;t know the file type so what I&rsquo;ll do, I will check its hexdump.</p>

<p><img src="http://hackolympus.com/images/magic-number/image-5.png"></p>

<p>through its hex dump I can easily see its a jpeg file as we know that magic number for jpeg is <strong><code>ffd8 ffe0 0010 4a96</code></strong>. Sure we could have also checked this without using hexdump and using <em><strong>file</strong></em> command but file command also uses the same logic.</p>

<p>But sometimes(specially in ctf challenges) hexdump is modified and file becomes corrupt hence unreadable so to fix that we modify the hashdump.</p>

<p>Now lets look another example.</p>

<p>I have a file named file2 I don&rsquo;t know its file type. So I use magic number to find out what file extension it has.</p>

<p><img src="http://hackolympus.com/images/magic-number/image-7.png"></p>

<p>And there we go, we found it its a pdf file.</p>

<p>I suggest you to practice with some of the files by yourself.</p>

<p>Check out this link to view the file signatures of different files.</p>

<p><a href="https://en.wikipedia.org/wiki/List_of_file_signatures">https://en.wikipedia.org/wiki/List_of_file_signatures</a></p>
]]></content>
  </entry>
  
</feed>
